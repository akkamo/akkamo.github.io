
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <title>Module configuration Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.1.1">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-emphasize/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-richquotes/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="module-dependencies.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../about.html">
            
                <a href="../about.html">
            
                    
                    What is Akkamo?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../how-it-works/">
            
                <a href="../how-it-works/">
            
                    
                    How it works?
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../how-it-works/lifecycle.html">
            
                <a href="../how-it-works/lifecycle.html">
            
                    
                    Akkamo Lifecycle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../how-it-works/module.html">
            
                <a href="../how-it-works/module.html">
            
                    
                    Akkamo Module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../how-it-works/context.html">
            
                <a href="../how-it-works/context.html">
            
                    
                    Akkamo Context
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../how-it-works/deployment.html">
            
                <a href="../how-it-works/deployment.html">
            
                    
                    Akkamo Deployment
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../modules/">
            
                <a href="../modules/">
            
                    
                    Core modules
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../modules/akka-module.html">
            
                <a href="../modules/akka-module.html">
            
                    
                    Akka module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../modules/akka-http-module.html">
            
                <a href="../modules/akka-http-module.html">
            
                    
                    Akka HTTP module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../modules/config-module.html">
            
                <a href="../modules/config-module.html">
            
                    
                    Config module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../modules/kafka-module.html">
            
                <a href="../modules/kafka-module.html">
            
                    
                    Kafka module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../modules/log-module.html">
            
                <a href="../modules/log-module.html">
            
                    
                    Log module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../modules/mongo-module.html">
            
                <a href="../modules/mongo-module.html">
            
                    
                    Mongo module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../modules/persistent-config-module.html">
            
                <a href="../modules/persistent-config-module.html">
            
                    
                    Persistent config module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../modules/reactivemongo-module.html">
            
                <a href="../modules/reactivemongo-module.html">
            
                    
                    ReactiveMongo module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../modules/webcontent-module.html">
            
                <a href="../modules/webcontent-module.html">
            
                    
                    Web content module
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="./">
            
                <a href="./">
            
                    
                    Best practices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.5.1" data-path="module-config.html">
            
                <a href="module-config.html">
            
                    
                    Module configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="module-dependencies.html">
            
                <a href="module-dependencies.html">
            
                    
                    Module dependencies
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Module configuration</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="module-configuration">Module configuration</h1>
<p>Careful design of the configuration structure is the important part of module design. Consistent,
clean and well-structured configuration, with comprehensive documentation will help other users to
easily adopt your module.</p>
<h2 id="basic-recommendations">Basic recommendations</h2>
<p><em>Akkamo platform</em> already provides mechanisms for loading configuration for your custom module, via
the following built-in modules:</p>
<ul>
<li><a href="../modules/config-module.html">Config module</a> - provides support for non-persistable, readonly
configuration, using the <a href="https://github.com/typesafehub/config" target="_blank">Typesafe Config</a> library</li>
<li><a href="../modules/persistent-config-module.html">Persistent config module</a> - provides support for
persistable configuration, with default implementation using the
<a href="https://www.mongodb.com" target="_blank">MongoDB</a> database as persistent storage</li>
</ul>
<p>Regardless of the selected configuration mechanism, you should keep in ming the following
recommendations when designing your configuration structure:</p>
<h3 id="use-namespaces">Use namespaces</h3>
<p>Anyhow your project name might be unique, you should never use names without proper namespace as a
root for your module configuration. Consider the following examples:</p>
<pre><code>// WRONG. This name may clash with other module&apos;s config and may cause ugly runtime problems.
httpServer {
  // config keys here
}

// RIGHT. Always use properly namespaced root for your configuration.
my.company.httpServer {
  // config keys here
}
</code></pre><h2 id="convention-over-configuration">Convention over configuration</h2>
<p>Either you are writing very simple module with no configuration required, or extensive plugin with
more complicated config, you should always respect the rule <em>convention over configuration</em>. Don&apos;t
make the user of your module feel lost in dozens of config keys. This can be easily avoided by using
default configuration where suitable, when no configuration explicitly provided by modules&apos;s user.</p>
<h3 id="example">Example</h3>
<p>As an example, let the following configuration represent the configuration of our fictional module,
providing simple <em>HTTP</em> server:</p>
<pre><code>com.mycompany.httpServer {
    host = localhost
    port = 8080
    protocol = http     // http, https
    timeout = 300       // [seconds]
}
</code></pre><p>All of the above configuration keys can be set as <em>optional</em>, with defaults set to values the
module&apos;s user would probably expected.</p>
<h3 id="summary">Summary</h3>
<ul>
<li>Use default values for omitted config keys where suitable, respect the
<em>convention over configuration</em> rule.</li>
<li>Always properly document your module configuration, and default values in your module
documentation.</li>
</ul>
<h2 id="configuring-provided-services">Configuring provided services</h2>
<p>Very often your module will provide custom <em>services</em> to another modules by registering them into
the <em>Akkamo context</em>. As those services usually needs some configuration,
designing this configuration structure properly and in unified way will help adopt your module more
easily by other users.</p>
<h3 id="example">Example</h3>
<p>As an example, let&apos;s extend previously shown fictional <em>HTTP</em> server module with possibility to
register multiple <em>HTTP</em> connections. Every configured connection will be registered into the
<em>Akkamo context</em> as an instance of service class <code>HttpConnection</code>. Below is example of well
structured, recommended way how to configure your services, with further explanation:</p>
<pre><code>com.mycompany.httpServer {
    httpConnection {
        default = true
        aliases = [ &quot;conn1&quot;, &quot;http&quot; ]
        host = localhost
        port = 8080
        protocol = http
    }
    httpsConnection {
        aliases = [ &quot;conn2&quot;, &quot;https&quot; ]
        host = localhost
        port = 8443
        protocol = https
    }
}
</code></pre><p>So what&apos;s happening here? Inside the root of our configuration, <code>com.mycompany.httpServer</code>, two
configuration blocks are defined. Each configuration block represents the configuration of single
<code>HttpConnection</code> service. Name of the configuration block (e.g. <code>httpConnection</code>) represents the
<em>key</em>, under which the connection will be registered into the <em>Akkamo context</em> and under which will
be available for injection. Same function have the <em>aliases</em>, under which the connection is also
available for injection. Next, notice the <code>default</code> config key. When one of the configuration is
marked as <em>default</em>, it is registered and can be injected without explicitly specifying the <em>key</em>.
Note that it should be always possible to mark only one configuration as <em>default</em>. When only one
configuration is present, it should be also considered as <em>default</em> without explicitly specifying
the <code>default</code> key.</p>
<p>Based on the recommendations and configuration example above, let&apos;s show how our configured services
can be injected:</p>
<ul>
<li><em>httpConnection</em><ul>
<li>using its name (i.e. <code>httpConnection</code>): <code>ctx.get[HttpConnection](&quot;httpConnection&quot;)</code></li>
<li>using one of the aliases: <code>ctx.get[HttpConnection](&quot;http&quot;)</code></li>
<li>injectig as <em>default</em>: <code>ctx.get[HttpConnection]</code></li>
</ul>
</li>
<li><em>httpsConnection</em><ul>
<li>using its name (i.e. <code>httpsConnection</code>): <code>ctx.get[HttpConnection](&quot;httpsConnection&quot;)</code></li>
<li>using one of the aliases: <code>ctx.get[HttpConnection](&quot;https&quot;)</code></li>
</ul>
</li>
</ul>
<h3 id="summary">Summary</h3>
<ul>
<li>Use consistent style for registered services configuration among your modules.</li>
<li>Each service should be registered into the <em>Akkamo context</em> under its name, and aliases.</li>
<li>You should register also <em>default</em> service instance, for the configuration marked as <em>default</em>
using the <code>default</code> config key, or implicitly if only one service configuration exists.</li>
<li>Keep in mind that combination of service type (e.g. <code>HttpConnection</code>) and <em>key</em>
(e.g. <code>httpConnection</code>) must be unique.</li>
</ul>
<h2 id="further-reading">Further reading</h2>
<ul>
<li><a href="../how-it-works/module.html">Akkamo Module</a></li>
<li><a href="../how-it-works/context.html">Akkamo Context</a></li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: Best practices">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="module-dependencies.html" class="navigation navigation-next " aria-label="Next page: Module dependencies">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Module configuration","level":"1.5.1","depth":2,"next":{"title":"Module dependencies","level":"1.5.2","depth":2,"path":"best-practices/module-dependencies.md","ref":"best-practices/module-dependencies.md","articles":[]},"previous":{"title":"Best practices","level":"1.5","depth":1,"path":"best-practices/index.md","ref":"best-practices/index.md","articles":[{"title":"Module configuration","level":"1.5.1","depth":2,"path":"best-practices/module-config.md","ref":"best-practices/module-config.md","articles":[]},{"title":"Module dependencies","level":"1.5.2","depth":2,"path":"best-practices/module-dependencies.md","ref":"best-practices/module-dependencies.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["emphasize","richquotes","puml"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"emphasize":{},"puml":{},"search":{},"lunr":{"maxIndexSize":1000000},"fontsettings":{"theme":"white","family":"sans","size":2},"richquotes":{},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"best-practices/module-config.md","mtime":"2016-11-14T12:44:27.099Z","type":"markdown"},"gitbook":{"version":"3.1.1","time":"2016-12-13T12:52:49.619Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

