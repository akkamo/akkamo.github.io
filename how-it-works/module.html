
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <title>Akkamo Module Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.1.1">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-emphasize/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-richquotes/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="context.html" />
    
    
    <link rel="prev" href="lifecycle.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../about.html">
            
                <a href="../about.html">
            
                    
                    What is Akkamo?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="./">
            
                <a href="./">
            
                    
                    How it works?
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="lifecycle.html">
            
                <a href="lifecycle.html">
            
                    
                    Akkamo Lifecycle
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.2" data-path="module.html">
            
                <a href="module.html">
            
                    
                    Akkamo Module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="context.html">
            
                <a href="context.html">
            
                    
                    Akkamo Context
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="deployment.html">
            
                <a href="deployment.html">
            
                    
                    Akkamo Deployment
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../modules/">
            
                <a href="../modules/">
            
                    
                    Core modules
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../modules/akka-module.html">
            
                <a href="../modules/akka-module.html">
            
                    
                    Akka module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../modules/akka-http-module.html">
            
                <a href="../modules/akka-http-module.html">
            
                    
                    Akka HTTP module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../modules/config-module.html">
            
                <a href="../modules/config-module.html">
            
                    
                    Config module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../modules/kafka-module.html">
            
                <a href="../modules/kafka-module.html">
            
                    
                    Kafka module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../modules/log-module.html">
            
                <a href="../modules/log-module.html">
            
                    
                    Log module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../modules/mongo-module.html">
            
                <a href="../modules/mongo-module.html">
            
                    
                    Mongo module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../modules/persistent-config-module.html">
            
                <a href="../modules/persistent-config-module.html">
            
                    
                    Persistent config module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../modules/reactivemongo-module.html">
            
                <a href="../modules/reactivemongo-module.html">
            
                    
                    ReactiveMongo module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../modules/webcontent-module.html">
            
                <a href="../modules/webcontent-module.html">
            
                    
                    Web content module
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../best-practices/">
            
                <a href="../best-practices/">
            
                    
                    Best practices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../best-practices/module-config.html">
            
                <a href="../best-practices/module-config.html">
            
                    
                    Module configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../best-practices/module-dependencies.html">
            
                <a href="../best-practices/module-dependencies.html">
            
                    
                    Module dependencies
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Akkamo Module</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="akkamo-module">Akkamo Module</h1>
<p><em>Akkamo module</em> is the cornerstone of each modular application based on this platform. Module is
nothing more than an old-good Scala class, implementing appropriate <em>traits</em> and their methods.
Each module is represented by the class implementing at least <code>eu.akkamo.Module</code> trait. For module
lookup during <em>Akkamo</em> startup, Java&apos;s
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html" target="_blank">ServiceLoader</a> mechanism
is used, therefore for each <em>Akkamo</em> module a new line with <em>fully qualified domain name</em> of
module&apos;s class must be added to the <code>eu.akkamo.Module</code> file located in the <code>META-INF/services/</code>
directory of module&apos;s JAR file.</p>
<h2 id="creating-new-akkamo-module">Creating new Akkamo module</h2>
<p>Akkamo module is nothing special but plain Scala class, implementing several traits. Each module
must implement the <code>eu.akkamo.Module</code> trait, example of the simplest possible module is below:</p>
<pre><code class="lang-scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Module</span> </span>{

  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dependencies</span></span>(dependencies: <span class="hljs-type">Dependency</span>): <span class="hljs-type">Dependency</span> = dependencies
}
</code></pre>
<p>Method <code>dependencies</code> needs some deeper explanation. If our module interacts with any other module
(e.g. injects its registered services), such module <strong>must</strong> be declared as our module&apos;s dependency.
This is done exactly using the <code>dependencies</code> method, using the following syntax:</p>
<pre><code class="lang-scala"><span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dependencies</span></span>(dependencies: <span class="hljs-type">Dependency</span>): <span class="hljs-type">Dependency</span> =
  dependencies.&amp;&amp;[<span class="hljs-type">ModuleA</span>].&amp;&amp;[<span class="hljs-type">ModuleB</span>]
</code></pre>
<p>The above example defines the <code>ModuleA</code> and <code>ModuleB</code> modules as dependencies.</p>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-4x fa-exclamation-triangle"></strong>
<p> Please pay attention to always properly define your module dependencies. If not done
so, dependend modules may not be properly initialized during the Akkamo initialization, which may
lead to unexpected runtime errors.</p>
</blockquote>
<h2 id="module-lifecycle">Module lifecycle</h2>
<p><em>Akkamo module</em> allows to run specific application code during every
<a href="lifecycle.html">Akkamo lifecycle</a>. For every lifecycle stage, there is appropriate Scala trait, which
has to be extended and implemented in order to run code during the selected lifecycle stage. Below
is the overview of available lifecycle Scala traits.</p>
<h3 id="initialization-stage">Initialization stage</h3>
<p>In order to run application code during the <em>initialization stage</em>, the trait
<em>eu.akkamo.Initializable</em> must be extended, as in following example:</p>
<pre><code class="lang-scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Module</span> <span class="hljs-keyword">with</span> <span class="hljs-title">Initializable</span> </span>{
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span></span>(ctx: <span class="hljs-type">Context</span>): <span class="hljs-type">Res</span>[<span class="hljs-type">Context</span>] = <span class="hljs-type">Try</span> {
    <span class="hljs-comment">// application code here</span>
  }
}
</code></pre>
<p>The <code>initialize</code> method is the called during the initialization stage of the <em>Akkamo lifecycle</em>.
This method may return <a href="http://www.scala-lang.org/api/current/index.html#scala.util.Try" target="_blank">Try</a> or
<a href="http://www.scala-lang.org/api/current/index.html#scala.concurrent.Future" target="_blank">Future</a> which is
implicitly converted into the <code>Res[Context]</code>.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-4x fa-info"></strong>
<p> In this lifecycle stage, you should register all your module services. Never do this in
any later stage.</p>
</blockquote>
<h3 id="run-stage">Run stage</h3>
<p>In order to run application code during the <em>run stage</em>, the trait
<em>eu.akkamo.Runnable</em> must be extended, as in following example:</p>
<pre><code class="lang-scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Module</span> <span class="hljs-keyword">with</span> <span class="hljs-title">Runnable</span> </span>{
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">run</span></span>(ctx: <span class="hljs-type">Context</span>): <span class="hljs-type">Res</span>[<span class="hljs-type">Context</span>] = <span class="hljs-type">Try</span> {
    <span class="hljs-comment">// application code here</span>
  }
}
</code></pre>
<h3 id="dispose-stage">Dispose stage</h3>
<p>In order to run application code during the <em>dispose stage</em>, the trait
<em>eu.akkamo.Disposable</em> must be extended, as in following example:</p>
<pre><code class="lang-scala"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyModule</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Module</span> <span class="hljs-keyword">with</span> <span class="hljs-title">Disposable</span> </span>{
  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dispose</span></span>(ctx: <span class="hljs-type">Context</span>): <span class="hljs-type">Res</span>[<span class="hljs-type">Unit</span>] = <span class="hljs-type">Try</span> {
    <span class="hljs-comment">// application code here</span>
  }
}
</code></pre>
<h2 id="registering-module-into-akkamo">Registering module into Akkamo</h2>
<p>When your module is ready, it must be explicitly registered into the <em>Akkamo</em>, in order to find and
run it during the application startup. As described in the beginning of the chapter, <em>Akkamo</em> uses
the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html" target="_blank">ServiceLoader</a>
mechanism. To register the module, following steps must be done:</p>
<ul>
<li>in the module <em>JAR</em> file, create directory <code>META-INF/services</code></li>
<li>in that directory, create new file called <code>eu.akkamo.Module</code></li>
<li>each line of this file should contain <em>fully qualified domain name</em> of your module
(e.g. <code>my.company.FooModule</code>), one line per module</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="lifecycle.html" class="navigation navigation-prev " aria-label="Previous page: Akkamo Lifecycle">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="context.html" class="navigation navigation-next " aria-label="Next page: Akkamo Context">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Akkamo Module","level":"1.3.2","depth":2,"next":{"title":"Akkamo Context","level":"1.3.3","depth":2,"path":"how-it-works/context.md","ref":"how-it-works/context.md","articles":[]},"previous":{"title":"Akkamo Lifecycle","level":"1.3.1","depth":2,"path":"how-it-works/lifecycle.md","ref":"how-it-works/lifecycle.md","articles":[]},"dir":"ltr"},"config":{"plugins":["emphasize","richquotes","puml"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"emphasize":{},"puml":{},"search":{},"lunr":{"maxIndexSize":1000000},"fontsettings":{"theme":"white","family":"sans","size":2},"richquotes":{},"highlight":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"how-it-works/module.md","mtime":"2016-11-14T12:44:27.099Z","type":"markdown"},"gitbook":{"version":"3.1.1","time":"2016-12-13T12:52:49.619Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

