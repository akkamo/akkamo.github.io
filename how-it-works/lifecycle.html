<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Akkamo Lifecycle | Akkamo Documentation</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-emphasize/plugin.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-richquotes/plugin.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../how-it-works/module.html" />
    
    
    <link rel="prev" href="../how-it-works/index.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="2.1"
        data-chapter-title="Akkamo Lifecycle"
        data-filepath="how-it-works/lifecycle.md"
        data-basepath=".."
        data-revision="Mon Jul 25 2016 12:43:33 GMT+0200 (CEST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="about.html">
            
                
                    <a href="../about.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        What is Akkamo?
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="how-it-works/index.html">
            
                
                    <a href="../how-it-works/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        How it works?
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="2.1" data-path="how-it-works/lifecycle.html">
            
                
                    <a href="../how-it-works/lifecycle.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Akkamo Lifecycle
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="how-it-works/module.html">
            
                
                    <a href="../how-it-works/module.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Akkamo Module
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="how-it-works/context.html">
            
                
                    <a href="../how-it-works/context.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Akkamo Context
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="modules/index.html">
            
                
                    <a href="../modules/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Core modules
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="modules/akka-module.html">
            
                
                    <a href="../modules/akka-module.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Akka module
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="modules/akka-http-module.html">
            
                
                    <a href="../modules/akka-http-module.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Akka HTTP module
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="modules/config-module.html">
            
                
                    <a href="../modules/config-module.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Config module
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="modules/kafka-module.html">
            
                
                    <a href="../modules/kafka-module.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Kafka module
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="modules/log-module.html">
            
                
                    <a href="../modules/log-module.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Log module
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="modules/persistent-config-module.html">
            
                
                    <a href="../modules/persistent-config-module.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        Persistent config module
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="modules/reactivemongo-module.html">
            
                
                    <a href="../modules/reactivemongo-module.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.</b>
                        
                        ReactiveMongo module
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Akkamo Documentation</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="akkamo-lifecycle">Akkamo Lifecycle</h1>
<p>Each <em>Akkamo</em> applications is nothing more than a set of selected modules. The<em>Akkamo</em> platform itself is the core,
which brings those modules into the life and joins them into fully working application. Before explaining the module
architecture itself, the lifecycle of the <em>Akkamo</em> application must be described in more details.</p>
<p>When <em>Akkamo</em> application starts, first step is to find all available modules at the classpath. For this purpose,
<em>Akkamo</em> uses the standard mechanism of Java,
called <a href="https://docs.oracle.com/javase/8/docs/api/java/util/ServiceLoader.html" target="_blank">Service loader</a>.
Some modules, however, may declare dependencies on other modules, i.e. dependent modules must be always initialized
before, so the correct order is calculated. Once correctly ordered, the first lifecycle stage, <em>initialization</em>,
is then performed.</p>
<h2 id="init-stage">Init stage</h2>
<p>This is the very first stage of <em>Akkamo</em> lifecycle, called right after the correct order of modules is achieved.
This is the stage where module should register its own functionality into the <em>context</em> (if necessary). In order
that a module can perform some logic in this stage, the <code>Initializable</code> interface and its method
<code>initialize(ctx: Context): Res[Context]</code> must be implemented.<br>
Actual version of <em>Akkamo</em> supports next implicit conversion to <code>Res</code> automatically:</p>
<h2 id="run-stage">Run stage</h2>
<p>After the initialization stage, when all modules are successfully initialized, this stage is executed. In order
to execute custom code in a module in this stage, the interface <code>Runnable</code> and its method <code>run(ctx: Context): Res[Context]</code>
must be implemented.</p>
<h2 id="dispose-stage">Dispose stage</h2>
<p>The first two stages, <em>Init</em> and <em>Run</em>, are performed during the application startup. This stage is performed when
the JVM gets the OS signal to stop, allowing modules to gracefully release allocated resources, close opened files,
ports, etc. In order that a module can perform some logic in this stage, the <code>Disposable</code> interface and its method
<code>dispose(ctx: Context): Res[Unit]</code> must be implemented.</p>
<h4 id="implicit-conversions">Implicit conversions</h4>
<p>Actual implementation of <em>Akkamo</em> supports several implicit conversion to <code>Res[Context]</code> or <code>Res[Unit]</code>, namely from:</p>
<ul>
<li><p><code>Context</code> :</p>
<pre><code class="lang-Scala">  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span>(</span>ctx: <span class="hljs-type">Context</span>) = {
    ...
    ctx.register(...)
  }
</code></pre>
</li>
<li><p><code>Try[Context]</code> :</p>
<pre><code class="lang-Scala">  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span>(</span>ctx: <span class="hljs-type">Context</span>) = <span class="hljs-type">Try</span> {
  ...
    ctx.register(...)
  }
</code></pre>
</li>
<li><p><code>Future[Context]</code> :</p>
<pre><code class="lang-Scala">  <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">initialize</span>(</span>ctx: <span class="hljs-type">Context</span>) = <span class="hljs-type">Future</span> {
  ...
    ctx.register(...)
  }
</code></pre>
</li>
</ul>
<h4 id="ordering">Ordering</h4>
<p>The modules form a dependency tree.<br>
Next simple rules works during module lifecycle management:</p>
<ul>
<li>Instances of modules are created in let say <code>random</code> order.</li>
<li>if module <strong>A</strong> depends on module <strong>B</strong> then <code>initialize</code> method of <strong>B</strong> is called before call of <code>initialize</code> on <strong>A</strong>.</li>
<li>if module <strong>A</strong> depends on module <strong>B</strong> then <code>run</code> method of <strong>A</strong> is called before call of <code>run</code> method on <strong>B</strong>.</li>
<li>if module <strong>A</strong> depends on module <strong>B</strong> then <code>dispose</code> method of <strong>A</strong> is called before call of <code>dispose</code> method on <strong>B</strong>.</li>
</ul>
<p>The rules get the possibility to have only two stages when system is initialized.<br>
For example, if an module depends on <strong>AkkaHttp</strong> module then also routes appending
works in <code>run</code> method, because &quot;run&quot; of Http module follows later.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../how-it-works/index.html" class="navigation navigation-prev " aria-label="Previous page: How it works?"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../how-it-works/module.html" class="navigation navigation-next " aria-label="Next page: Akkamo Module"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.5-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax-beta/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"emphasize":{},"richquotes":{},"mathjax-beta":{},"puml":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
